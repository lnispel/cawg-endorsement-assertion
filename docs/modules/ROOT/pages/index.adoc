= Forward Permissions Credential
:toc: macro
:toc-title:
:sectanchors:
:sectnums:

A _<<_forward_permissions_credential,Forward Permissions Credential (FPC)>>_ is a W3C Verifiable Credential that grants specific permissions to perform actions on C2PA assets, backed by the issuer's Identity Claims Aggregation Credential (ICAC). The FPC enables a sophisticated permission delegation system where content creators can grant machine-readable rights to trusted parties while maintaining cryptographic proof of their identity and authority. (See xref:_generating_an_fpc[xrefstyle=full].)

*Version 2.0 Draft 15 July 2024* Â· xref:_version_history[]

[#maintainers]
*Maintainers:*

* mailto:scouten@adobe.com[Eric Scouten] (https://adobe.com[Adobe])

include::partial$license.adoc[]
include::partial$contributing.adoc[]
include::partial$foreword.adoc[]
include::partial$toc.adoc[]

== Introduction

_This section is non-normative._

=== Overview

The Forward Permissions Credential (FPC) system establishes a comprehensive identity and permissions framework that enables:

1. **Identity Claims Aggregation Credential (ICAC)** - Proof of identity/attributes
2. **Forward Permissions Credential (FPC)** - Proof of permissions granted to others  
3. **C2PA Manifest** - Links content to identity
4. **Verifiable Presentation** - Combines ICAC + FPC for verification

This system provides a sophisticated permission delegation mechanism where content creators can grant machine-readable rights to trusted parties while maintaining cryptographic proof of their identity and authority.

=== Use case

As one example, a content creator with an established ICAC may want to grant permission to a content-distribution network to transcode their C2PA asset as part of a publication workflow. The creator issues an FPC that identifies the licensee, references their ICAC for identity assurance, and includes ODRL policies that define the scope, duration, and terms of the permission. When the transcoder creates their C2PA asset containing the ingredient, they include the FPC as a *forward permissions assertion,* which lets the C2PA Manifest consumer know that the actions they performed have been properly authorized.

== Normative references

* https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html[C2PA technical specification, version 2.0]
* https://www.w3.org/TR/vc-data-model/[W3C Verifiable Credentials Data Model]
* https://www.w3.org/ns/odrl/2/[ODRL 2.2 Ontology]
* https://www.w3.org/TR/did-core/[Decentralized Identifiers (DIDs)]

== Terms and definitions

=== Actor

A human or non-human (hardware or software) that is participating in the C2PA ecosystem. For example: a camera (capture device), image editing software, cloud service, or the person using such tools.

NOTE: An organization or group of _actors_ may also be considered an _actor._

=== C2PA asset

A file or stream of data containing _digital content,_ _asset metadata,_ and a _<<C2PA Manifest>>_.

For the purposes of this definition, we will extend the typical definition of "file" to include cloud-native and dynamically-generated data.

IMPORTANT: The definition of "C2PA asset" in this specification differs from the definition of "asset" given in the C2PA technical specification. A "C2PA asset" as defined in _this_ specification MUST contain a _<<C2PA Manifest>>._

=== C2PA Manifest

The set of information about the _provenance_ of a _<<C2PA asset>>_ based on the combination of one or more assertions, a single C2PA claim, and a claim signature.

See link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_manifests++[Section 11, "Manifests,"] of the C2PA technical specification.

=== Forward Permissions Credential (FPC)

A W3C Verifiable Credential that grants specific permissions to perform actions on C2PA assets, backed by the issuer's Identity Claims Aggregation Credential (ICAC). The FPC includes ODRL policies that define the scope, duration, and terms of the granted permissions.

=== Identity Claims Aggregation Credential (ICAC)

A W3C Verifiable Credential that bundles or references verified claims about an entity (e.g., KYC, socials, endorsements) and is signed to their DID. This provides the identity assurance that backs FPCs.

=== Licensee

An _<<_actor,actor>>_ who receives a _<<_forward_permissions_credential,Forward Permissions Credential>>_ to perform a limited set of actions.

=== Licensor

An _<<_actor,actor>>_ who provides a _<<_forward_permissions_credential,Forward Permissions Credential>>_ authorizing a _<<_licensee,licensee>>_ to perform a limited set of actions on specific _<<C2PA asset>>_ signed by the _licensor._

[#generating_an_fpc]
== Generating a Forward Permissions Credential

=== Licensor workflow

Any _<<_actor,actor>>_ with an established ICAC MAY choose to become a _<<_licensor,licensor>>_ by producing the following outputs:

* a _<<C2PA asset>>_ and a corresponding _<<C2PA Manifest>>_ (which MAY be embedded in the _<<_c2pa_asset,C2PA asset>>_)
* a _<<_forward_permissions_credential,Forward Permissions Credential>>,_ as defined in xref:_fpc_schema[xrefstyle=full]

IMPORTANT: A _<<_forward_permissions_credential,Forward Permissions Credential>>_ MUST reference the licensor's ICAC to provide identity assurance. The FPC SHOULD be provided separately to the _<<_licensee,licensee>>_ and MAY be included in C2PA Manifests as a forward permissions assertion.

The relationship among _<<_licensor,licensor>>_, _<<_licensee,licensee>>_, and the _<<_licensor,licensor's>>_ _<<C2PA Manifest>>_ is represented by the following diagram, which is non-normative:

[mermaid,width=100%]
....
erDiagram
    lr["Licensor"] {
        did decentralizedIdentifier
        icac identityCredential
    }
    icac["ICAC"] {
        verifiedClaims kyc
        verifiedClaims endorsements
        verifiedClaims socials
    }
    fpc["FPC"] {
        licensee did
        permittedActions actions
        odrlPolicy terms
        icacReference assurance
    }
    cm["C2PA Manifest"] {
        assertions anyAssertions
        cose-sig claimSignature
    }
    ca["C2PA Asset"] {
        c2pa-manifest manifest
    }

    lr ||--|| icac: "has"
    lr ||--|| fpc: "issues"
    lr ||--|| cm: "creates and signs"
    icac ||--|| fpc: "backs"
    cm ||--|| ca: "describes"
    fpc ||--|| lr: "references"
....

=== Licensee workflow

A _<<_licensee,licensee>>,_ once in possession of a _<<C2PA asset>>_ and a _<<_forward_permissions_credential,Forward Permissions Credential>>_ signed by the same _<<_actor,actor>>_ that signed the _<<_c2pa_asset,C2PA asset's>>_ _<<C2PA Manifest>>,_ MAY choose to perform one or more of the actions permitted in xref:_permitted_actions[xrefstyle=full], and describe those actions in a new _<<C2PA Manifest>>._

The _<<_licensee,licensee>>_ MAY include the _<<_forward_permissions_credential,Forward Permissions Credential>>_ by adding a *forward permissions assertion* in the new _<<C2PA Manifest>>'s_ assertion store.

Before generating a *forward permissions assertion,* the _<<_licensee,licensee>>_ MUST ensure that:

* exactly one link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_actions++[`c2pa.actions` assertion] exists in the _<<C2PA Manifest>>,_
* only the actions listed under xref:_permitted_actions[xrefstyle=full] are present in the actions assertion,
* exactly one link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_ingredient++[ingredient assertion] is present in the assertion store, and,
* that ingredient is the one referenced by the actions assertion's `parameters.ingredient` field.

The *forward permissions assertion* MUST have a label of `cawg.forwardPermissions`. The assertion contents MUST be a `COSE_Sign1_Tagged` structure that contains the FPC.

There MUST NOT be more than one *forward permissions assertion* in any _<<C2PA Manifest>>._

The relationship between the _<<_licensor,licensor's>>_ _<<C2PA asset>>_ and the _<<_licensee,licensee's>>_ _<<C2PA asset>>_ is illustrated by the following diagram, which is non-normative:

[mermaid,width=100%]
....
erDiagram
    ca["Licensor's C2PA asset"] {
        c2pa-manifest manifest
    }
    aa["Actions assertion"] {
        list actionsPerformed
    }
    ia["Ingredient assertion"] {
        ref licensorsAsset
    }
    fpc["Forward Permissions Credential"] {
        licensee did
        permittedActions actions
        odrlPolicy terms
        icacReference assurance
    }
    fpa["Forward permissions assertion"] {
        ref fpc
    }
    lee["Licensee"] {
        did decentralizedIdentifier
    }
    leas["Licensee's C2PA asset"] {
        c2pa-manifest manifest
    }
    leem["Licensee's C2PA manifest"] {
        assertion ingredients
        assertion actions
        assertion forwardPermissions
        cose-sig claimSignature
    }

    ca ||--|| ia: "referenced by"
    lee ||--|| leem: "creates and signs"
    lee ||--|| aa: "creates"
    fpc ||--|| fpa: "included in"
    aa ||--|| leem: "included in"
    ia ||--|| leem: "included in"
    fpa ||--|| leem: "included in"
    leem ||--|| leas: "describes"

....

[#permitted_actions]
=== Permitted actions

The link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_actions++[`c2pa.actions` assertion] in a _<<C2PA Manifest>>_ containing a *forward permissions assertion* MAY contain any of the following action codes:

* `c2pa.published`
* `c2pa.transcoded`
* `c2pa.repackaged`
* `c2pa.edited`
* `c2pa.distributed`

The actions assertion MUST NOT contain any other action codes.

[#fpc_schema]
=== FPC Schema

_<<_forward_permissions_credential,Forward Permissions Credentials>>_ follow the W3C Verifiable Credentials Data Model and are fully compatible with CAWG 1.2 identity assertion model. Key components include:

* **Terms of Use** - C2PAAssetBinding with referenced assertions, roles, and ODRL policies
* **Credential Subject** - Licensee identification and forward permissions details
* **Asset binding** - C2PA manifest references with hash verification
* **Permitted actions** - List of allowed C2PA actions (published, transcoded, repackaged, edited, distributed)
* **Delegation support** - Optional delegation to other DIDs via `delegatedTo`
* **Identity hooks** - Expected countersigners for trust validation
* **mDL compatibility** - Nonce binding for mobile driver's license integration
* **Issuer identity** - Reference to the licensor's ICAC for identity assurance
* **Schema.org integration** - Semantic markup for enhanced discoverability and interoperability

The complete schema is defined in xref:_fpc_schema[xrefstyle=full].

Examples are available for both basic FPC credentials and VP-wrapped FPC credentials demonstrating holder-signed permissions.

== Validation

Validation of a *forward permissions assertion* SHALL only be attempted if the active _<<C2PA Manifest>>_ first meets a number of conditions:

* There is exactly one link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_actions++[actions assertion] present in the assertion store.
* There is exactly one link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_ingredient++[ingredient assertion].
* There is exactly one *forward permissions assertion.*

For each `action` object in the link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_actions++[actions assertion]:

. Check that the `action` field is set to `c2pa.published`, `c2pa.transcoded`, `c2pa.repackaged`, `c2pa.edited`, or `c2pa.distributed`. If any other action is present, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Check the `ingredient` field that is a member of the `parameters` object for the presence of a JUMBF URI. If the JUMBF URI is not present, or cannot be resolved to the related ingredient assertion, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Follow the JUMBF URI link in the `ingredient` field to the ingredient assertion. Check that the URI link resolves to the single ingredient assertion in the active _<<C2PA Manifest>>._ If it does not, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation. Check that the `relationship` field is `parentOf`. If it is not, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Check the `c2pa_manifest` field in the ingredient assertion for the presence of a hashed URI. If the hashed URI is not present, or cannot be resolved to a _<<C2PA Manifest>>,_ fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Follow the JUMBF URI link in the `c2pa_manifest` field to the ingredient's _<<C2PA Manifest>>._ Ensure that this _ingredient_ _<<C2PA Manifest>>_ has been validated according to link:++https://c2pa.org/specifications/specifications/2.0/specs/C2PA_Specification.html#_recursively_validating_integrity_of_ingredients++[Section 15.8, "Recursively validating integrity of ingredients," of the C2PA 2.0 Technical Specification], but do not skip the establishing of signer credential trust. If it does not validate, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Validate the FPC as a W3C Verifiable Credential according to the VC Data Model specification. If validation fails, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Validate the FPC's ODRL policy according to the ODRL 2.2 specification. If validation fails, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Validate the FPC's reference to the licensor's ICAC. Ensure the ICAC is valid and contains the necessary identity claims. If validation fails, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. Validate that the active _<<C2PA Manifest>>_ signer's credential matches the licensee specified in the FPC. If the comparison fails, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. If the active _<<C2PA Manifest>>_ is timestamped, then the _time-stamp_ must fall within the FPC's validity time range. If it does not, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.
. If the active _<<C2PA Manifest>>_ is not timestamped, then the _time of validation_ must fall within the FPC's validity time range. If it does not, fail the *forward permissions assertion* validation process for this _<<C2PA Manifest>>_ and do not proceed with further validation.

If all steps above have been completed without failure, the *forward permissions assertion* SHOULD be considered valid.

== Alignment with CAWG Identity Assertions

The Forward Permissions Credential system is designed to work seamlessly with the evolving CAWG Identity Assertion framework. Key alignment points include:

=== C2PAAssetBinding Integration

FPCs use the same `C2PAAssetBinding` structure as identity assertions, enabling:

* **Unified asset binding** - Both identity and permissions reference the same C2PA assertions
* **Consistent validation** - Same validation rules apply to both credential types
* **Interoperable workflows** - Identity and permissions can be combined in Verifiable Presentations

=== Verifiable Presentation Support

FPCs can be wrapped in Verifiable Presentations (VPs) to enable:

* **Holder-signed permissions** - Licensees can sign their own permission requests
* **Multi-credential bundles** - Identity and permission credentials can be combined
* **Flexible delegation** - Support for complex permission delegation chains

=== Delegation Mechanisms

The FPC system supports delegation through:

* **Direct delegation** - `delegatedTo` field in termsOfUse
* **VP-based delegation** - Holder can delegate permissions via VP
* **Chain validation** - Delegation chains are validated according to CAWG rules

=== Verifiable Presentation Support

The FPC system supports wrapping credentials in Verifiable Presentations (VPs) to enable:

* **Holder-signed permissions** - Licensees can sign their own permission requests via VP
* **Extended permissions** - VP can add additional `termsOfUse` with `C2PAAssetBinding`
* **Multi-credential bundles** - Multiple FPCs can be combined in a single VP
* **Delegation workflows** - VP enables complex permission delegation chains

VP examples demonstrate how licensees can extend or modify permissions while maintaining cryptographic proof of their authority.

=== Future Extensions

The FPC system is designed to support future CAWG extensions including:

* **mDL integration** - Mobile driver's license credential support
* **Claim generator attestations** - Enhanced trust from claim generators
* **Persistent ID support** - Long-term identity continuity
* **Schema.org integration** - Enhanced semantic markup for better discoverability and search engine optimization

include::partial$version-history.adoc[]
